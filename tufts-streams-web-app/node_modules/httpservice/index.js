// Generated by CoffeeScript 1.3.3
(function() {
  var path, request;

  request = require('request');

  path = require('path');

  module.exports = function(baseUrl) {
    var del, fullUrl, get, handle, post, put;
    baseUrl = baseUrl.replace(/\/$/, "");
    fullUrl = function(url) {
      return baseUrl + url;
    };
    handle = function(cb) {
      return function(err, rs, body) {
        var _ref, _ref1;
        if (err != null) {
          return cb(err);
        }
        if (rs.statusCode >= 300) {
          return cb(new Error("" + ((_ref = rs.request) != null ? _ref.method : void 0) + " " + ((_ref1 = rs.request) != null ? _ref1.href : void 0) + " failed with " + rs.statusCode));
        }
        return cb(null, body);
      };
    };
    get = function(url, cb) {
      return request.get({
        url: fullUrl(url),
        json: {}
      }, handle(cb));
    };
    post = function(url, body, cb) {
      return request.post({
        url: fullUrl(url),
        json: body
      }, handle(cb));
    };
    put = function(url, body, cb) {
      return request.put({
        url: fullUrl(url),
        json: body
      }, handle(cb));
    };
    del = function(url, cb) {
      return request.del({
        url: fullUrl(url),
        json: {}
      }, handle(cb));
    };
    return {
      handle: handle,
      get: get,
      post: post,
      put: put,
      "delete": del
    };
  };

}).call(this);
